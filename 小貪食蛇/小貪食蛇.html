<!DOCTYPE html>
<html lang="zh-TW">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Document</title>
		<style>
			.map {
				width: 800px;
				height: 600px;
				background-color: #ccc;
				position: relative;
			}
		</style>
		<script>
			window.onload = function () {
				//自調用函數---食物的
				(function () {
					var elements = [];

					function Food(x, y, width, height, color) {
						this.x = 0;
						this.y = 0;
						this.width = width || 20;
						this.height = height || 20;
						this.color = color || "red";
					}


					//為原型添加初始化方法，在地圖上面顯示食物
					//因為食物要在地圖上顯示，所以需要地圖這個參數
					//map就是葉面上的.class="map"，也就是個div 【<div class="map"></div>】
					Food.prototype.init = function (map) {
						//如果elements裡面有食物子元素的話，先刪除
						remove();
						//創建一個div
						var div = document.createElement("div");
						//把這個元素放到父元素上面
						map.appendChild(div);
						//設置div的樣式
						div.style.width = this.width + "px";
						div.style.height = this.height + "px";
						div.style.backgroundColor = this.color;
						//脫離文檔流
						div.style.position = "absolute";
						//隨機橫縱座標
						this.x = parseInt(Math.random() * (map.offsetWidth / this.width)) * this.width;
						this.y = parseInt(Math.random() * (map.offsetHeight / this.height)) * this.height;
						div.style.left = this.x + "px";
						div.style.top = this.y + "px";
						console.log(this.x);
						console.log(this.y);
						console.log(div.style.top);

						//把div加入到數組elements中，未來食物被小蛇吃掉後，要把它刪掉
						elements.push(div);
					};
					//私有函數--刪除食物用的，注意，不能用prototype
					function remove() {
						//elements中有這個食物
						for (var i = 0; i < elements.length; i++) {
							var ele = elements[i];
							//找到這個元素的父級元素，然後刪除這個子元素
							ele.parentNode.removeChild(ele);
							//再次把elements裡面的這個子元素也要刪掉
							elements.splice(i, 1);
						}
					}
					window.Food = Food;

				}());
				//自調用函數---小蛇的身體
				(function () {
					var elements = []; //存放小蛇的每個身體部位
					function Snake(width, height, direction) {
						//小蛇的每個部份寬
						this.width = width || 20;
						this.height = height || 20;
						//小蛇的身體
						this.body = [{
								x: 3,
								y: 2,
								color: "red"
							},
							{
								x: 2,
								y: 2,
								color: "yellow"
							},
							{
								x: 1,
								y: 2,
								color: "yellow"
							}
						];
						this.direction = direction || "right";
					}
					//為原型添加方法---小蛇初始化的方法
					Snake.prototype.init = function (map) {
						//循環遍歷創建div
						for (var i = 0; i < this.body.length; i++) {
							//數組中的每個數組都是一個對象
							var obj = this.body[i];
							//把div加到地圖中
							var div = document.createElement("div");
							map.appendChild(div);
							//設置div樣式，脫離文檔流
							div.style.position = "absolute";
							div.style.width = this.width + "px";
							div.style.height = this.height + "px";
							//橫縱座標
							div.style.left = obj.x * this.width + "px";
							div.style.top = obj.y * this.height + "px";
							console.log(obj.x, div.style.left,obj.y, div.style.top);


							//背景顏色
							div.style.backgroundColor = obj.color;
							//方向暫時不定

							//把div加入到elements的數組中----目的是為了刪除
							elements.push(div);

						}
					};
					//把小蛇暴露給window，外部可以訪問
					window.Snake = Snake;
				}());

				var fd = new Food();
				fd.init(document.querySelector(".map"));
				var snake = new Snake();
				snake.init(document.querySelector(".map"));

				//console.log(fd.height);
			}
		</script>
	</head>

	<body>
		<div class="map"></div>

	</body>

</html>